<!-- @format -->

TLS/SSL
SSL 是加密套件，TLS 是 SSL 的升级，现在提到 HTTPS 基本上指的是 TLS
是指应用层与传输层之间的加密层
TLS/SSL 中使用了非对称加密，对称加密以及 HASH 算法

### 对称加密：加密数据用的秘钥与解密数据用的秘钥一致

优点： 加密解密效率高
缺点：共享一把秘钥，有泄露风险，且来那个良之间需要分配并维护一把秘钥，成本较高

### 非对称加密

公钥：加密数据用的密钥
私钥： 解密数据用的秘钥

私钥能解开公钥加密的数据；公钥能解开私钥加密的数据

## HTTPS

在生成对称加密的密钥环节使用非对称加密方式，之后的建立通信交换报文阶段则使用对称加密方式。

## SSL 握手(TLS1.3 版本使用椭圆曲线加密)

1. 客户端发送请求
   1.1 支持的协议版本
   1.2 客户端生成的随机数
   1.3 支持的加密方法如 RAS
   1.4 支持的压缩方法

2. 服务器响应
   2.1 确认协议版本如 TSL1.1/1.2/1.3，如果浏览器与服务器支持版本不一致，服务器关闭加密通道
   2.2 服务器生成随机数
   2.3 确认使用的加密方法
   2.4 服务器证书

3. 客户端回应
   3.1 验证证书，如果证书有问题就弹出提示，如果用户忽略或者没问题就继续
   3.2 从证书中提取服务器的公钥
   3.3 生成随机数，用服务器公钥加密
   3.4 编码改变通知，表示随后用双方商定的加密方法和秘钥发送
   3.5 握手结束通知，同时发送所有内容的 hash 值，供服务端校验
   注：此时，有了客户端随机数，服务端随机数及 pre-master-key，通过事先商定的加密方法生成会话秘钥
4. 服务端最后回应
   4.1 用自己的私钥解密 pre-master-key，根据客户端随机数，服务端随机数与 pre-master-key，生成会话秘钥
   4.2 编码改变通知，表示随后的信息都将用双方商定的加密方法与密钥发送
   4.3 握手结束，发送所有内容的 hash 供客户端校验

## 参考资料

https://mp.weixin.qq.com/s/4_ZxDy1xE-rn9g6D2yH_fw
https://www.cnblogs.com/ttltry-air/archive/2012/08/20/2647898.html
https://mp.weixin.qq.com/s/Yh58lpq9Czo7SGzzdeAHUA
https://zhuanlan.zhihu.com/p/37636276
https://juejin.cn/post/6844904178330894343
