<!-- @format -->

## HTTP1.1 解决了 HTTP1.0 的两大问题

1. TCP 连接无法复用
2. 队头阻塞，每个请求只能依次发送，第二个请求要在第一个请求响应之后发送

## HTTP1.1 优点

1. 长连接
2. 管线化：可以同时发送多个 HTTP 请求，无须等到上一个请求返回结果。但是，第一个请求处理结果返回后，第二个请求才会响应
3. 增加了与缓存相关的请求头 cache-controle etag
4. 带宽优化，range 请求头加入支持断点续传功能
5. Host 请求头，没有 Host 请求头，会报错
6. 缓存处理：E-tag,if-none-match 等缓存信息

## HTTP1.1 缺点

1. 没有真正解决队头阻塞的问题
2. 明文传输，安全问题
3. 请求头体积庞大，增加传输成本；HTTP/1.1 的首部无法压缩，再加上 cookie 的存在，经常会出现首部大小比请求数据大小还大的情况。
4. 开启 keep-alive 可能会给服务器增加压力
5. HTTP/1.1 无法为重要的资源指定优先级，每个 HTTP 请求都是一视同仁。
6. 低效的 TCP 利用

## HTTP2 优点

1. 二进制分帧
   客户端与服务端通过交换帧来通信
   帧组成：Steam Identifier，用于控制流，可以跟踪逻辑流的帧成员关系；Type，帧类型，标识帧的用途；Length，帧开始到结束的长度；Flags，帧的状态信息；Frame payload，请求正文
2. 多路复用：传输时无序，接受时组装。HTTP 请求是基于流的，然后将每个流分割成若干个帧。
3. 单一长连接：HTTP2 中用一条单一的长连接，避免了创建多个 TCP 连接带来的网络开销，提高了吞吐量。
4. 头部压缩：HPACK 压缩算法
5. 服务端推送
6. 资源优先级设置
7. 流控制：允许接收者主动示意停止发送或减少发送的数据量

## HTTP2 未解决的问题

1. TCP 队头阻塞
   TCP 数据包是有序传输，中间一个数据包丢失，会等待该数据包重传，造成后面的数据包的阻塞。

## 其他

1. HTTP 队头阻塞：一个 tcp 通道中如果某个 http 请求的响应因为某个原因没有及时返回，后面的响应会被阻塞，这就是队头阻塞
   队头阻塞的解决方法：1）对一个域名建立多个 TCP 连接 chrome 最多 6 个；2）域名分片，更多的域名建立更多的 TCP 连接；3）HTTP2
